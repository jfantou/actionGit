on:
  workflow_dispatch:

jobs:
  hello_world_job:
    runs-on: ubuntu-latest
    name: A job to say hello
    steps:
      - name: Obtain a GitHub App Installation Access Token
        id: githubAppAuth
        run: |
          TOKEN="$(npx obtain-github-app-installation-access-token ci eyJhcHBJZCI6IjMzMzczMCIsImluc3RhbGxhdGlvbklkIjoiMzc1MTU4MjUiLCJwcml2YXRlS2V5IjoiLS0tLS1CRUdJTiBSU0EgUFJJVkFURSBLRVktLS0tLVxuTUlJRXBRSUJBQUtDQVFFQTJnU2Q5OVlDc01TNnZGSWdMYy92RVcrTm45Qk1Hb0RaMlR5L3FMQWI5V2RtNy9rRVxudkJLcVlIbU5wVzlJYUNlWithSWhCVG9sSWhGYUpYeUlaVVRCZlIwMTNNL2IyR21GTCtzOGlEaisyeUZMY1hEWVxua0VrdlRRcEt2bWovRUNwZXlBNkxrZnZnR3c2U24yTEdiS3ZRZEU1MjlWSC94Sllsb2ZlenZPS0J1bG51dWFZYlxuQVNPMzF3a3lHVVczRkFzQ3FORWRoS0hVbiswR3VPOG5HNldEWStSZlZKdzVtVUk4Qk02N25ULzJPS3pxQmRHUlxudVRaTWxwNVNvVXY4MlRnU09GcEZxaW16T2lYdTlsVUxaTDE5eHQvN1QyVk0ybVdnQkY2NXB1NkRQd2VvVUo3bFxuc1plMHlaRzFidDFIZU9PQUpHM1J5b2pBMktwOUgxSXBvTXh5NXdJREFRQUJBb0lCQUQvQWNlRHk5NzV4Q0puZ1xuK2YvcmVlRURXY3FOd25OTmttWnYyU3Vlczg1Qytscloyb1NVZ0xYTlZabzJ2Rm1ZbXZIZ2N2OXdUVU4xQjROR1xuc3l2SnV6cTJ1L1ZoNHN1WnI1U2ZtUWZNZ3RuWkZwS0ppUXBJSEVqTzVhUmdWNVdHamtpNTJCNU1KUEJFaHFPTVxuNHJFTVhOeGx4V3RmR3dlRlVHUFladnFvMFg2SUczRDNKdkNhS3VJTEY3bTdIVzZwTzRSc29yVnNodGpoVm5oU1xuakgrblMrZ1AyR2JWTi9CU0xYcEZmV1Y2TlltUnF1TGkzcjJBcGdZK0M4NTlFTUpoSWt2bUpMY2ZtUVlBUHNGcVxuSG9aT3o5VDlwQktROUJiYytaOWlmWU5hVXp3RkRaeUZtZkoxNW1Xb241Z0wveXdyYlhLTGt4aEtSdjcxMm5JYlxuWlovMnR5RUNnWUVBOTZCM01kKzhRV0hJT3owbi9MVzNlbVloZzdsdlpTdmE4UWNSVzlkbC9tdmtkUlZxYTg1eFxuZDhFaHVDbmQ5RVlRcGVQWjVoSnpSUnBVV0V6eWRFTkg0Z2lyOFppWlo2V0hmTHRPNTZuUi9yc2Z4U3F0ZkRTZ1xucTM1aExnSWpVV0RITFRuRzRmQlZ4YVRDV1RkRTNHNkVWNnllZERmVXJUK0t0M0Q3MDhPUEoxMENnWUVBNFdQWlxuUWd3Und5SGUvenptVkNCY2V1RkdTM3h5T3pyazhTMXh5enkzZThsb3NTVGlORStFSG5SQ3ZSZXlPWGZVcjVTQlxuWm9EaXVMMURZTTdPeHRmWms2cHBjY0srdWh6MjNsdWJVNmVCZEtFR1A2YmVUaHlsRElLZllqVkh0cm5jSEdKTlxuYmJaM1RZTm1nY1dnak9wRzRLNHhFdEpGWHpDbWRaV3VCZjFaTXhNQ2dZRUE2Y3BMbnYvZ3FrNGFrS3R0dkc4SVxuV254Z2VoQXlkdStQMTI1WDJrRWtYN0FYMHQ4MFNiSndlS01VSmQ4SldoNW9pMmJ6REFBeGFuV3dXbW5Ub3liK1xua0E2bDRBUzJHU0EwS2ZSaVMrQ09qaFMzcXh4ZkROeFhNWEt4WjVISExJYlZwZ0pkbm1XZFpXdm52Zm1yZnY2c1xuM21Yd2VFTlovWFAza0xnUVdsL1JJVlVDZ1lFQXFhVXQ4YmlENWd1b2ZSU3BpTWlTMHlxY2JsVE01aWYrQ2tuYVxuVE03MmpBV2M5emg3eWtQUGZkeWtIdyttNWZwNzYyd3J1YXRvK3dQNW92UUdUMFJJVUEwRU1Nd1VJcUdLYnZNa1xuaG1LZDNkc1ZpUE5nZ0FxdmNDc2hMQnBPVUFxMDBlaHJ2eGlIMDZBRGw4bllmamdZQVNVYmFyODUxOXdXYm9xcVxuNFhjL25HRUNnWUVBdXczZXdJSlVucDdEN2I5WExvakJnOFlCaGoydlZIVG0vOFc4eXo1NHpZZVMremFtVDVrMVxuY3FPTCs5Q0tkeXlLQUV6L1d1RHZBUnNORUhtR0lYZm85UmE5bitKdlIwMjZSQ3JlcEdaMlJtN1daVHkvZmN6ZVxuODM4Q0FEV2EvWnVubkZ1N05GNmQrN3BoT0IxVVdXNkJqSWpUUkVBVTZMUlJaVzBsdGI5VE5Ocz1cbi0tLS0tRU5EIFJTQSBQUklWQVRFIEtFWS0tLS0tIn0=)"
          echo "::add-mask::$TOKEN"
          echo "::set-output name=token::$TOKEN"
      - name: Use the obtained token
        run: |
          curl -X POST -H 'Content-Type: application/json' \
            -d '{"context":"test","state":"success"}' \
            -H "Authorization: Bearer $GITHUB_TOKEN"\
            "https://api.github.com/orgs/orgjerome2/repos"
        env:
          GITHUB_TOKEN: ${{ steps.githubAppAuth.outputs.token }}
      - name: Hello world action step
        id: hello
        uses: jfantou/actionGit@v1.2
